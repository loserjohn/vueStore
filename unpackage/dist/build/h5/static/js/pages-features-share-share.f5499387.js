(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-features-share-share"],{"19ec":function(t,e,a){var i=a("c8c6");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("108616e4",i,!0,{sourceMap:!1,shadowMode:!1})},"69f0":function(t,e,a){"use strict";var i=a("4ea4");a("99af"),a("7db0"),a("4160"),a("d3b7"),a("3ca3"),a("159b"),a("ddb0"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,a("96cf");var n=i(a("1da1")),s=i(a("4d41")),r=i(a("b508")),o=a("84a3"),c=(a("2f62"),{data:function(){return{providerList:[],poster:{},qrShow:!1,canvasId:"default_PosterCanvasId",imgs:[],imgSrc:"",QrSrc:"",Title:" ",ShortTitle:"",PriceTxt:"",Coupon:"",shareUrl:"",currentBg:0,canvasH:"",canvasW:"",currentShow:0,load:!1,all:!1,canvasPic:"",usrMsg:"",tkl:"",errMsg:"",id:"",show:!1,registe_type:3}},computed:{},onLoad:function(t){var e=uni.getSystemInfoSync();this.registe_type=t.type,this.canvasH=.7*e.safeArea.height;var a=.6;this.canvasW=this.canvasH*a;uni.getStorageSync("poster");this.imgSrc=5==this.registe_type?"../../../static/img/fx_ywy.jpg":"../../../static/img/fx_bg.jpg",this.Title="邀请人:".concat(this.accountInfo.consumer_name),this.ShortTitle="邀请码:".concat(this.accountInfo.invitation_code),this.shareUrl="".concat(s.default.mainUrl,"/web/index.html?action=").concat(5==this.registe_type?"ywshare":"khshare","action&payload=").concat(this.accountInfo.invitation_code,"payload")},methods:{createHB:function(){this.show=!0,this.shareFc()},_copy:function(t){return(0,n.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return");case 7:return t.abrupt("break",13);case 8:return e._share(0),t.abrupt("break",13);case 10:return e._share(1),t.abrupt("break",13);case 12:return t.abrupt("break",13);case 13:case"end":return t.stop()}}),t)})))()},_share:function(t){var e=this;plus.nativeUI.showWaiting(),setTimeout((function(){plus.nativeUI.closeWaiting()}),1500),uni.share({provider:e.providerList[t].id,scene:e.providerList[t].type&&"WXSenceTimeline"==e.providerList[t].type?"WXSenceTimeline":"WXSceneSession",type:2,title:"洁利来",summary:"邀您下载酷熊APP，让您淘宝天猫购物省钱",imageUrl:e.poster.finalPath,href:e.shareUrl,success:function(t){plus.nativeUI.toast("分享成功"),clipboard.setText("")},fail:function(t){e.errMsg="温馨提示：分享失败，请及时检查微信及洁利来pro相机等权限是否打开，必要时可以卸载重装app，微信重装前切记先做好数据备份，以防丢失，具体可点击右下角问号图标进入新手引导",e.$refs.resultModal._showDialog(),clipboard.setText("")}})},shareFc:function(){var t=this;return(0,n.default)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,e.prev=1,e.next=4,(0,o.getSharePoster)({_this:t,type:"testShareType",formData:{},posterCanvasId:t.canvasId,delayTimeScale:20,background:{width:2*a.canvasW,height:2*a.canvasH,backgroundColor:"#fff"},bgScale:.5,drawArray:function(t){var e=t.bgObj,i=(t.type,t.bgScale,22),n=.05*e.width,s=.09*e.width;e.width;return new Promise((function(t,o){t([{type:"image",url:a.imgSrc,alpha:1,infoCallBack:function(t){return{roundRectSet:{r:1},dx:0,dy:0,dWidth:e.width,dHeight:e.height-i}}},{type:"qrcode",text:a.shareUrl,correctLevel:3,size:.2*e.width,dx:i,dy:e.height-i-.2*e.width},{type:"text",text:a.Title,size:n,color:"#333",alpha:1,textAlign:"left",textBaseline:"top",infoCallBack:function(t){return r.default.log("index页面的text的infocallback ，textlength:"+t),{dx:2*i+.2*e.width,dy:e.height-.2*e.width-i}},lineFeed:{maxWidth:e.width-i,lineHeight:s,lineNum:2,dx:-1},serialNum:0,id:"tag1"},{type:"text",text:a.ShortTitle,size:n,color:"#333",alpha:1,textAlign:"left",textBaseline:"top",serialNum:1,lineFeed:{maxWidth:3.6*e.width,lineHeight:s,lineNum:1,dx:-1},allInfoCallback:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.drawArray;a.find((function(t){return"tag1"===t.id}));return new Promise((function(t,a){setTimeout((function(){t({dx:2*i+.2*e.width,dy:e.height-i-.1*e.width})}),1)}))}}])}))},setCanvasToTempFilePath:function(){return{destWidth:900,destHeight:1500}},quality:1});case 4:i=e.sent,t.poster.finalPath=i.poster.tempFilePath,t.canvasPic=i.poster.tempFilePath,t.qrShow=!0,e.next=15;break;case 10:e.prev=10,e.t0=e["catch"](1),r.default.hideLoading(),r.default.showToast(JSON.stringify(e.t0)),console.log(JSON.stringify(e.t0));case 15:case"end":return e.stop()}}),e,null,[[1,10]])})))()},saveImage:function(t){switch(t){case 1:this.$refs.uToast.show({title:"长按图片，保存到相册",type:"info"});break;case 2:this.$refs.uToast.show({title:"长按图片，发送给好友",type:"info"});break;case 3:this.$refs.uToast.show({title:"长按图片，发送到朋友圈",type:"info"});break;default:break}},_downAll:function(){var t=this;if(this.all)plus.nativeUI.toast("你已经下载该组图，请勿重复下载");else{plus.nativeUI.showWaiting();var e=[];this.imgs.forEach((function(a,i){e.push(t.save(i))}));var a=this;Promise.all(e).then((function(t){console.log(t),a.errMsg="已下载商品组图,赶紧去分享吧",a.$refs.resultModal._showDialog(),plus.nativeUI.closeWaiting()})).catch((function(t){console.log(t),plus.nativeUI.toast("图片丢失"),plus.nativeUI.closeWaiting()})),this.all=!0}},save:function(t){var e=this;return new Promise((function(a){var i=e;uni.saveImageToPhotosAlbum({filePath:i.imgs[t],success:function(){a()}})}))}}});e.default=c},"85b2":function(t,e,a){"use strict";a.r(e);var i=a("69f0"),n=a.n(i);for(var s in i)"default"!==s&&function(t){a.d(e,t,(function(){return i[t]}))}(s);e["default"]=n.a},"97f6":function(t,e,a){"use strict";a.r(e);var i=a("9dbe"),n=a("85b2");for(var s in n)"default"!==s&&function(t){a.d(e,t,(function(){return n[t]}))}(s);a("ac8a");var r,o=a("f0c5"),c=Object(o["a"])(n["default"],i["b"],i["c"],!1,null,"220b7a30",null,!1,i["a"],r);e["default"]=c.exports},"9dbe":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return i}));var i={tuiButton:a("a2ae").default,tuiToast:a("1c18").default,tuiModal:a("5a57").default,tuiIcon:a("9c13").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{staticClass:"pages "},[i("v-uni-view",{staticClass:"contentBox"},[i("v-uni-image",{staticClass:"contentBG",attrs:{src:t.imgSrc,mode:"widthFix"}})],1),i("v-uni-view",{staticClass:"footer flex flex_center"},[i("tui-button",{attrs:{shape:"circle",type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.createHB.apply(void 0,arguments)}}},[t._v("生成海报分享")])],1),i("v-uni-view",{staticClass:"hideCanvasView"},[i("v-uni-canvas",{staticClass:"canvas",style:{width:2*t.canvasW+"px",height:2*t.canvasH+"px"},attrs:{"canvas-id":"default_PosterCanvasId"}})],1),i("tui-toast",{ref:"uToast"}),i("tui-modal",{attrs:{show:t.show,backgroundColor:"transparent",custom:!0,padding:"0rpx",maskClosable:!0}},[i("v-uni-view",{staticClass:"sharebgBox flex flex_y"},[i("v-uni-image",{staticClass:"bgcanvasPic",attrs:{src:t.canvasPic,mode:"widthFix"}}),i("v-uni-view",{staticClass:"flex flex_center u-row-between u-col-center",staticStyle:{width:"100%",padding:"20rpx 80rpx"}},[i("v-uni-view",{staticClass:"flex flex_y  f1",on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.saveImage(1)}}},[i("v-uni-image",{staticClass:"sbtns",attrs:{src:a("ef0b")}}),i("v-uni-text",{staticStyle:{color:"#fff","margin-top":"16rpx"}},[t._v("保存海报")])],1),i("v-uni-view",{staticClass:"flex flex_y  f1",on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.saveImage(2)}}},[i("v-uni-image",{staticClass:"sbtns",attrs:{src:a("b144")}}),i("v-uni-text",{staticStyle:{color:"#fff","margin-top":"16rpx"}},[t._v("微信好友")])],1),i("v-uni-view",{staticClass:"flex flex_y  f1",on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.saveImage(3)}}},[i("v-uni-image",{staticClass:"sbtns",attrs:{src:a("88be")}}),i("v-uni-text",{staticStyle:{color:"#fff","margin-top":"16rpx"}},[t._v("朋友圈")])],1)],1),i("v-uni-view",{staticClass:"flex flex_center u-row-center u-col-center",staticStyle:{width:"100%",padding:"20rpx 80rpx"}},[i("tui-icon",{attrs:{name:"close",color:"#fff",size:40},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.show=!1}}})],1)],1)],1)],1)],1)},s=[]},ac8a:function(t,e,a){"use strict";var i=a("19ec"),n=a.n(i);n.a},c8c6:function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.pages[data-v-220b7a30]{width:100vw;min-height:calc(100vh - %?88?%);overflow:hidden;background:#fff;position:relative}.pages .hideContent[data-v-220b7a30]{width:100vw;height:100vh;position:fixed;background:rgba(0,0,0,.7);z-index:100}.pages .contentBox[data-v-220b7a30]{width:100vw;height:calc(100vh - %?88?% - %?160?%);overflow:hidden}.pages .contentBox .contentBG[data-v-220b7a30]{width:100%;height:100vh}.pages .footer[data-v-220b7a30]{width:100vw;height:%?160?%;background-color:#fff;padding:%?20?%;position:absolute;left:0;bottom:0}.pages .hideCanvasView[data-v-220b7a30]{position:fixed;top:%?-99999?%;left:%?-99999?%;z-index:-99999}.pages .canvasPic[data-v-220b7a30]{border-radius:%?28?%;overflow:hidden;width:100%;height:100%}.pages .sbtns[data-v-220b7a30]{width:%?80?%;height:%?80?%;border-radius:50%}.pages .sbtns[data-v-220b7a30]:active{-webkit-transform:translate(%?1?%,%?1?%);transform:translate(%?1?%,%?1?%)}.pages .bgcanvasPic[data-v-220b7a30]{width:90%;border-radius:%?20?%;overflow:hidden}.pages .sharebgBox[data-v-220b7a30]{width:100%;height:auto;border-radius:%?20?%;overflow:hidden}',""]),t.exports=e}}]);